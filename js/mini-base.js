window.amulex||(window.amulex={}),window.amulex.helpers||(window.amulex.helpers={}),window.amulex.helpers.cookies={getCookie:e=>{const t=document.cookie.match("(^|;) ?"+e+"=([^;]*)(;|$)");return t?decodeURIComponent(t[2]):null},setCookie:(e,t,a={})=>{(a={path:"/",...a}).expires instanceof Date&&(a.expires=a.expires.toUTCString());let o=encodeURIComponent(e)+"="+encodeURIComponent(t);for(let e in a){o+="; "+e;let t=a[e];!0!==t&&(o+="="+t)}document.cookie=o},deleteCookie:e=>{setCookie(e,"",{"max-age":-1})}};const template='<div class="ajax-loader-wrap">\n    <div class="ajax-loader"></div>\n</div>';class AjaxLoader{constructor(e){this.element=e,this.init()}init(){this.element.classList.contains("ajax-area")||this.element.classList.add("ajax-area"),jQuery(this.element).find("> .ajax-loader").length||jQuery(this.element).append(template)}show(){this.element.classList.add("active");let e=jQuery(this.element);e.find("> .box__more").length&&e.find("> .box__more").css("visibility","hidden")}hide(){let e=jQuery(this.element);e.find("> .box__more").length&&e.find("> .box__more").attr("style",""),this.element.classList.remove("active")}}const contentToggler=(e,t)=>{const a=document.querySelector(e),o=document.querySelector(".content__open"),s=a.scrollHeight,n=a.clientHeight;a.style.maxHeight=s>n?s+"px":n,o.style.display="none"},initContentToggler=(e,t)=>{const a=document.querySelector(t),o=document.querySelector(e).clientHeight;a.style.maxHeight=o+"px"},initContentTogglers=()=>{document.querySelectorAll(".js-text-toggle").forEach((e=>{e.addEventListener("click",(e=>{e.stopPropagation(),contentToggler(".content")}))}))},sectionLoader=function(e){const t=e.currentTarget,a=document.querySelector(`${t.dataset.container} .insert-before`),o=document.querySelector(`${t.dataset.container} ${t.dataset.loader}`),s=new AjaxLoader(o),n=new URL(t.dataset.url);n.search=new URLSearchParams(t.dataset).toString(),s.show(),fetch(n).then((e=>e.json())).then((e=>{a.insertAdjacentHTML("beforebegin",e.html),t.dataset.last=parseInt(t.dataset.last)+parseInt(e.count),s.hide(),e.buttonVisibility||(o.style.display="none")})).catch((e=>{s.hide(),console.log(e)}))},classToggler=e=>{const t=e.currentTarget,a=t.dataset.container,o=t.dataset.target,s=t.dataset.className,n=void 0!==t.dataset.hide&&Boolean(t.dataset.hide);window.document.querySelector(a).querySelectorAll(o).forEach((e=>{toggleClass(e,s)})),n&&(t.style.display="none")},toggleClass=(e,t)=>{e.classList.contains(t)?e.classList.remove(t):e.classList.add(t)},reachGoal=function(e){let t=window.yaCounter42964584;e&&t&&t.reachGoal(e)},reachGoalGoogle=function(e){e&&window.dataLayer&&window.dataLayer.push(e),window.ga&&e&&window.ga("send",e)},reachGtag=function(e){gtag&&gtag("event","submit",e)},reachMailRu=function(e){(window._tmr||(window._tmr=[])).push({id:"3217855",type:"reachGoal",goal:e})},reachLeadGoal=()=>{var e,t;e={event_category:"tilda_form"},gtag&&gtag("event","submit",e),reachGoal("Тильда (тестирование)"),t="LeadForm1",(window._tmr||(window._tmr=[])).push({id:"3217855",type:"reachGoal",goal:t})},fancyboxOptions={autoFocus:!0,clickSlide:!1,clickOutside:!1,keyboard:!0,padding:0,scrolling:"no",helpers:{overlay:{locked:!0}},touch:!1,lang:"en",i18n:{en:{CLOSE:"Закрыть"}},afterLoad:function(e,t){let a=t.$content;if(!a)return!0;let o=a.get(0);if(o.dataset.popupController)return;o.dataset.popupType;o.dataset.popupController="true"},afterShow:function(e,t){let a=t.$content;if(!a)return!0;initTippy(),initForms(a[0]),window.yandex&&window.yandex.autofill&&window.initYaAutoComplete(),setTimeout((()=>{a.addClass("complete"),a.find(".js-form-control").first().focus()}),300)},beforeClose:function(e,t){let a=t.$content;if(!a)return!0;a.removeClass("complete")}},openPopup=function(e,t=!1,a=!1){var o={};jQuery.extend(o,fancyboxOptions),t&&jQuery.extend(o,{ajax:{settings:{data:t}}}),a||jQuery.fancybox.close(),jQuery.fancybox.open({src:e,type:"ajax",opts:o})},maskInput=function(e){if(e.data("mask")){const t=e.data("mask"),a=t&&t.mask&&t.mask.toString()||"+7 (999) 999 99 99";e.mask(a)}},initMask=function(){$(".js-mask").each(((e,t)=>{maskInput($(t))}))},initFormValidate=function(e){e.validator=jQuery(e).validate({ignore:".ignore",focusInvalid:!0,onfocusout:!1,onclick:!1,errorPlacement:function(e,t){const a=t.parent("fieldset").find(".js-error-label-container");a.length?a.append(e):e.insertAfter(t)},highlight:function(e){let t=jQuery(e);t.hasClass("select2-hidden-accessible")?jQuery("#select2-"+t.attr("id")+"-container").closest(".form-row").addClass("error"):(t.addClass("error"),t.closest(".form-row").addClass("error"))}.bind(this),unhighlight:function(e){let t=jQuery(e);t.hasClass("select2-hidden-accessible")?jQuery("#select2-"+t.attr("id")+"-container").closest(".form-row").removeClass("error"):(t.removeClass("error"),t.closest(".form-row").removeClass("error"))}.bind(this)})},sendData=function(e){const t=new AjaxLoader(e);t.show();var a=e.action;const o=new XMLHttpRequest,s=new FormData(e);s.append("recaptchaLoaded",!1),o.addEventListener("load",(function(a){e.classList.contains("js-no-goal")||reachLeadGoal();const o=JSON.parse(a.target.response),s="form-customJs-";e.classList.forEach((a=>{if(a.startsWith(s)){const n=a.substr(s.length);if(window.hasOwnProperty(n))return window[n](e,o),void t.hide()}})),o.popup?(t.hide(),e.reset(),openPopup(o.popup,!1,o.noClose)):(o.result&&o.hide&&$(o.hide).hide(),o.result&&o.show&&(o.hasOwnProperty("display")?$(o.show).css("display",o.display):$(o.show).show()),o.result&&o.hasOwnProperty("addClass")&&Object.entries(o.addClass).forEach((([e,t])=>{document.querySelectorAll(e).forEach((e=>e.classList.add(t)))})),o.result&&o.scrollToBread&&$("html, body").animate({scrollTop:$(".breadcrumbs").offset().top}),o.result&&o.redirect?window.location=o.redirect:t.hide())})),o.addEventListener("error",(function(e){alert("Oops! Something went wrong.")})),o.open("POST",a),o.send(s)},loadScript=e=>{const t=document.createElement("script");t.src=e,document.head.appendChild(t)},callAtNigth=()=>{const e=new Date;(!e||e.getHours()>=21||e.getHours()<=8)&&document.querySelectorAll(".js-can-call-at-nigth").forEach((e=>{e.removeAttribute("style")}))},initForms=function(e){let t;t=e?e.getElementsByTagName("form"):document.getElementsByTagName("form"),callAtNigth();for(let e=0;e<t.length;e++){initFormValidate(t[e]);const a="form-onload-customJs-";t[e].classList.forEach((o=>{if(o.startsWith(a)){const s=o.substr(a.length);if(window.hasOwnProperty(s))return void window[s](t[e])}})),t[e].addEventListener("input",(function(e){e.preventDefault();const t=e.target;"+7 (8"!=t.value&&"+7 (7"!=t.value||(t.value="+7 (")})),t[e].addEventListener("submit",(function(e){e.preventDefault();const t=e.target,a=jQuery(t);let o=!0;const s=a.find("#dataPolicy2");s.length>0&&(o=s.prop("checked")),o?$(".form__label--checkbox").removeClass("checkbox-error"):$(".form__label--checkbox").addClass("checkbox-error");let n=!0;t.querySelectorAll(".radio--buttons").forEach((e=>{e.querySelector("input:checked")?e.classList.remove("box-error"):(e.classList.add("box-error"),n=!1)})),a.valid()&&n&&o?sendData(t):t.validator.focusInvalid()}))}$(".js-mask").each(((e,t)=>{maskInput($(t))}))};class ClassWatcher{constructor(e,t,a,o){this.targetNode=e,this.classToWatch=t,this.classAddedCallback=a,this.classRemovedCallback=o,this.observer=null,this.lastClassState=e.classList.contains(this.classToWatch),this.init()}init(){this.observer=new MutationObserver(this.mutationCallback.bind(this)),this.observe()}observe(){this.observer.observe(this.targetNode,{attributes:!0})}disconnect(){this.observer.disconnect()}mutationCallback(e){for(let t of e)if("attributes"===t.type&&"class"===t.attributeName){let e=t.target.classList.contains(this.classToWatch);this.lastClassState!==e&&(this.lastClassState=e,e?this.classAddedCallback(t.target):this.classRemovedCallback(t.target))}}}const classChangeListener=(e,t,a,o)=>{document.querySelectorAll(e).forEach((e=>{e.classList.contains(t)?a(e):new ClassWatcher(e,t,a,o)}))},lazyLoadBackgroundImages=async function(){var e,t,a,o;e=".background-image",t="lazyloaded",a=function(e){(e=$(e)).hide();const t=e.attr("src");e.parents("section.main__header:not(.background-image-loaded), .js-background-image-container:not(.background-image-loaded)").first().css("background-image",`url(${t})`).addClass("background-image-loaded")},o=function(e){},document.querySelectorAll(e).forEach((e=>{e.classList.contains(t)?a(e):new ClassWatcher(e,t,a,o)}))},asyncOlwCarousel=async function(e,t){jQuery(e).length&&jQuery(e).owlCarousel(t)};function catchHash(e=!1){if(window.hasOwnProperty("skipCatchHashFlag")&&0===window.skipCatchHashFlag)return void window.skipCatchHashFlag;const t=window.location.hash;if(t){let a;try{a=$(t)}catch(e){return}if(a&&a.length>0){let a=$(t).css("padding-top").split("px");a=a[0];let o=$(t).offset().top-a,s=browser.isTouch()?56:0;o-=s,o-=$("header").height();const n=()=>{$("html, body").stop().animate({scrollTop:o},0)};e?setTimeout((()=>{n()}),0):n()}}}function ytInit(){$(".yt-video").on("click",(function(e){const t=$(this);if(t.data("yt")){const e=t.data("yt");if("content"in document.createElement("template")){const t=document.querySelector("#youtube-video").content.cloneNode(!0);t.querySelector("#yt-frame").src="https://www.youtube.com/embed/"+e,jQuery.fancybox.open(t)}}}))}document.querySelectorAll(".alert__close").forEach((e=>{e.addEventListener("click",(e=>{e.currentTarget.parentNode.style.display="none"}))})),window.addEventListener("hashchange",catchHash,!1);const stickySidebar=()=>{if($(".sidebar").hasClass("is-touch"))return!0;const e=$("header.header")[0].clientHeight,t=$("header.header").offset().top,a=$(".js-section-sidebar-top"),o=t+e,s=a&&a.offset()&&a.offset().top,n=$(window).scrollTop();$(".section:not(#callback)").each((function(e){if($(this).position().top-42<=n){$(".sidebar__item--current").removeClass("sidebar__item--current");e-1>=0&&$(".sidebar__item").eq(e-1).addClass("sidebar__item--current")}})),$(".sidebar").each((function(){const e=$(this),t=$(this).find(".sidebar__list")[0].clientHeight,a=e.position().top+t,n=$(".section").last().height(),r=$(".section").last().position().top+n,i=$("header.header")[0].getBoundingClientRect().bottom+$(window).scrollTop(),c=$(".sidebar")[0].getBoundingClientRect().top+$(window).scrollTop()-i;e.is(":visible")||e.css("display","block"),o<=s-70?(e.css("top",s-70-1),e.hasClass("sidebar--rel")||e.addClass("sidebar--rel")):a>r-40&&c<52?(e.addClass("sidebar--rel"),e.css("top",r-t)):e.hasClass("sidebar--rel")&&(e.css("top",144),e.removeClass("sidebar--rel"))})),$("window").scroll()},sidebarAdapt=()=>{const e=$(".sidebar");e.hasClass("sidebar-experts")||($("body").width()<=1280?e.hasClass("is-touch")||(e.addClass("is-touch"),e.css("display","none")):e.hasClass("is-touch")&&(e.removeClass("is-touch"),e.insertAfter($(".breadcrumbs-sect")),e.css("display","block"),e.css("top",401),e.css("margin-bottom","unset")))},initPopupFromHash=()=>{const e=window.location.hash;if(0===e.indexOf("#popup")){const t=document.querySelectorAll(".js-"+e.substr(1));t.length&&fancyboxLinkClick(t[0]),history.pushState(window.page,window.title,window.location.href.replace(e,""))}},fancyboxLinkClick=(e,t)=>{e.dataset.close&&jQuery.fancybox.close();let a=e.dataset.type||"ajax";const o=Object.assign({},e.dataset);let s=!1,n={};return o.hasOwnProperty("post")&&o.post&&(o._token=$('meta[name="csrf-token"]').attr("content"),n=Object.assign({},fancyboxOptions,{ajax:{settings:{data:o,type:"POST"}}}),s=!0),jQuery.fancybox.open({src:e.dataset.href||e.attributes.href.value,type:a,opts:s?n:fancyboxOptions}),!1},addYandexIdToLink=e=>{e.dataset.yandexTryCount||(e.dataset.yandexTryCount=0);let t=document.cookie.match("(^|;) ?_ym_uid=([^;]*)(;|$)");t?e.href=changeLinkSearchItem(e,"yandexClientId",unescape(t[2])):e.dataset.yandexTryCount<=20&&(e.dataset.yandexTryCount=(parseInt(e.dataset.yandexTryCount)+1).toString(),setTimeout(addYandexIdToLink,1e3,e))},fetchUtmToFront=()=>{let e=null;document.querySelectorAll(".js-fetch-utm").forEach((t=>{null===e?(e=!1,fetch("/api/get-utm").then((e=>e.json())).then((a=>{e=a,Object.entries(e).forEach((([e,a])=>{t.href=changeLinkSearchItem(t,e,a)})),addYandexIdToLink(t)}))):!1===e?setTimeout((t=>{Object.entries(e).forEach((([e,a])=>{t.href=changeLinkSearchItem(t,e,a)})),addYandexIdToLink(t)}),3e3,t):(Object.entries(e).forEach((([e,a])=>{t.href=changeLinkSearchItem(t,e,a)})),addYandexIdToLink(t))}))},changeLinkSearchItem=(e,t,a)=>{const o=new URL(e.href),s=new URLSearchParams(o.search);return s.set(t,a),o.search=s.toString(),o.toString()},initSidebar=()=>{stickySidebar(),sidebarAdapt(),window.addEventListener("scroll",stickySidebar),window.addEventListener("resize",sidebarAdapt)},initTippy=()=>{console.log("tippy"),tippy(".js-tippy",{placement:"bottom-start",theme:"label",arrow:!0})};window.addEventListener("load",(function(){document.querySelectorAll(".js-text-toggle").forEach((e=>{e.addEventListener("click",(e=>{e.stopPropagation(),contentToggler(".content")}))})),initForms(),lazyLoadBackgroundImages(),catchHash(!0),fetchUtmToFront(),initPopupFromHash(),initTippy(),$(".js-fancy").on("click",(function(e){$(this).data("image")?jQuery.fancybox.open("<img src='"+e.currentTarget.dataset.href+"'/>"):openPopup(e.currentTarget.dataset.href)})),document.querySelectorAll(".js-lead-goal").forEach((e=>e.addEventListener("click",reachLeadGoal))),document.querySelectorAll(".js-yandex-goal").forEach((e=>e.addEventListener("click",(e=>{reachGoal(e.currentTarget.dataset.goal)}))));const e=$(".btn--fav");e.each((function(){const e=parseInt($(this).data("expert-id"));if(e){const t=JSON.parse(localStorage.getItem("favLawyers"));t&&-1!==t.indexOf(e)&&$(this).addClass("btn--fav-active")}})),e.on("click",(function(e){const t=parseInt($(this).data("expert-id"));if(t){let e=!1,a=JSON.parse(localStorage.getItem("favLawyers"));if(a){let o=a.indexOf(t);-1!==o?a.splice(o,1):(a.push(t),e=!0)}else a=[t],e=!0;a=a.length>0?JSON.stringify(a):null,a?localStorage.setItem("favLawyers",a):localStorage.removeItem("favLawyers"),e?$(this).hasClass("btn--fav-active")||$(this).addClass("btn--fav-active"):$(this).removeClass("btn--fav-active")}}))}));
